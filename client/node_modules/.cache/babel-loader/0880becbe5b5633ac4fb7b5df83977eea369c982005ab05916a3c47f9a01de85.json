{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Box,Typography,CircularProgress,Alert,Container,Drawer,List,ListItem,ListItemIcon,ListItemText,Toolbar,AppBar,CssBaseline,Button,Grid,Paper}from'@mui/material';import DashboardIcon from'@mui/icons-material/Dashboard';import RestaurantMenuIcon from'@mui/icons-material/RestaurantMenu';import CategoryIcon from'@mui/icons-material/Category';import LocalOfferIcon from'@mui/icons-material/LocalOffer';import{supabase}from'../supabaseClient';import MenuManager from'./MenuManager';import AdminOrders from'./AdminOrders';import CategoryManager from'./CategoryManager';import CouponManager from'./CouponManager';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const drawerWidth=220;const AdminDashboard=()=>{const[loading,setLoading]=useState(true);const[isAdmin,setIsAdmin]=useState(false);const[error,setError]=useState('');const[selectedMenu,setSelectedMenu]=useState('dashboard');useEffect(()=>{const checkAdmin=async()=>{setLoading(true);setError('');const{data:{user},error:userError}=await supabase.auth.getUser();if(userError||!user){setError('You must be logged in.');setLoading(false);return;}const{data,error:profileError}=await supabase.from('profiles').select('role').eq('id',user.id).single();if(profileError||!data){setError('Profile not found.');setLoading(false);return;}if(data.role==='admin'){setIsAdmin(true);}else{setError('You are not authorized to view this page.');}setLoading(false);};checkAdmin();},[]);if(loading){return/*#__PURE__*/_jsx(Container,{maxWidth:\"md\",sx:{mt:8,textAlign:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{})});}if(error){return/*#__PURE__*/_jsx(Container,{maxWidth:\"sm\",sx:{mt:8},children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:error})});}return/*#__PURE__*/_jsxs(Box,{sx:{display:'flex'},children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(AppBar,{position:\"fixed\",sx:{zIndex:theme=>theme.zIndex.drawer+1},children:/*#__PURE__*/_jsx(Toolbar,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",noWrap:true,component:\"div\",children:\"Admin Dashboard\"})})}),/*#__PURE__*/_jsxs(Drawer,{variant:\"permanent\",sx:{width:drawerWidth,flexShrink:0,[\"& .MuiDrawer-paper\"]:{width:drawerWidth,boxSizing:'border-box'}},children:[/*#__PURE__*/_jsx(Toolbar,{}),/*#__PURE__*/_jsx(Box,{sx:{overflow:'auto'},children:/*#__PURE__*/_jsxs(List,{children:[/*#__PURE__*/_jsxs(ListItem,{button:true,selected:selectedMenu==='dashboard',onClick:()=>setSelectedMenu('dashboard'),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(DashboardIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Dashboard Home\"})]}),/*#__PURE__*/_jsxs(ListItem,{button:true,selected:selectedMenu==='menu',onClick:()=>setSelectedMenu('menu'),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(RestaurantMenuIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Menu Management\"})]}),/*#__PURE__*/_jsxs(ListItem,{button:true,selected:selectedMenu==='categories',onClick:()=>setSelectedMenu('categories'),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(CategoryIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Categories & Subcategories\"})]}),/*#__PURE__*/_jsxs(ListItem,{button:true,selected:selectedMenu==='orders',onClick:()=>setSelectedMenu('orders'),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(RestaurantMenuIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Orders\"})]}),/*#__PURE__*/_jsxs(ListItem,{button:true,selected:selectedMenu==='coupons',onClick:()=>setSelectedMenu('coupons'),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(LocalOfferIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Coupons & Offers\"})]})]})})]}),/*#__PURE__*/_jsxs(Box,{component:\"main\",sx:{flexGrow:1,p:3},children:[/*#__PURE__*/_jsx(Toolbar,{}),selectedMenu==='dashboard'&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Welcome, Admin!\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"Use the side menu to manage menu items and more.\"})]}),selectedMenu==='menu'&&/*#__PURE__*/_jsx(MenuManager,{}),selectedMenu==='categories'&&/*#__PURE__*/_jsx(CategoryManager,{}),selectedMenu==='orders'&&/*#__PURE__*/_jsx(AdminOrders,{}),selectedMenu==='coupons'&&/*#__PURE__*/_jsx(CouponManager,{})]})]});};export default AdminDashboard;","map":{"version":3,"names":["React","useEffect","useState","Box","Typography","CircularProgress","Alert","Container","Drawer","List","ListItem","ListItemIcon","ListItemText","Toolbar","AppBar","CssBaseline","Button","Grid","Paper","DashboardIcon","RestaurantMenuIcon","CategoryIcon","LocalOfferIcon","supabase","MenuManager","AdminOrders","CategoryManager","CouponManager","jsx","_jsx","jsxs","_jsxs","drawerWidth","AdminDashboard","loading","setLoading","isAdmin","setIsAdmin","error","setError","selectedMenu","setSelectedMenu","checkAdmin","data","user","userError","auth","getUser","profileError","from","select","eq","id","single","role","maxWidth","sx","mt","textAlign","children","severity","display","position","zIndex","theme","drawer","variant","noWrap","component","width","flexShrink","boxSizing","overflow","button","selected","onClick","primary","flexGrow","p","gutterBottom"],"sources":["E:/food-ordering-website/client/src/pages/AdminDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Box, Typography, CircularProgress, Alert, Container, Drawer, List, ListItem, ListItemIcon, ListItemText, Toolbar, AppBar, CssBaseline, Button, Grid, Paper\r\n} from '@mui/material';\r\nimport DashboardIcon from '@mui/icons-material/Dashboard';\r\nimport RestaurantMenuIcon from '@mui/icons-material/RestaurantMenu';\r\nimport CategoryIcon from '@mui/icons-material/Category';\r\nimport LocalOfferIcon from '@mui/icons-material/LocalOffer';\r\nimport { supabase } from '../supabaseClient';\r\nimport MenuManager from './MenuManager';\r\nimport AdminOrders from './AdminOrders';\r\nimport CategoryManager from './CategoryManager';\r\nimport CouponManager from './CouponManager';\r\n\r\nconst drawerWidth = 220;\r\n\r\nconst AdminDashboard = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [selectedMenu, setSelectedMenu] = useState('dashboard');\r\n\r\n  useEffect(() => {\r\n    const checkAdmin = async () => {\r\n      setLoading(true);\r\n      setError('');\r\n      const { data: { user }, error: userError } = await supabase.auth.getUser();\r\n      if (userError || !user) {\r\n        setError('You must be logged in.');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      const { data, error: profileError } = await supabase\r\n        .from('profiles')\r\n        .select('role')\r\n        .eq('id', user.id)\r\n        .single();\r\n      if (profileError || !data) {\r\n        setError('Profile not found.');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      if (data.role === 'admin') {\r\n        setIsAdmin(true);\r\n      } else {\r\n        setError('You are not authorized to view this page.');\r\n      }\r\n      setLoading(false);\r\n    };\r\n    checkAdmin();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container maxWidth=\"md\" sx={{ mt: 8, textAlign: 'center' }}>\r\n        <CircularProgress />\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Container maxWidth=\"sm\" sx={{ mt: 8 }}>\r\n        <Alert severity=\"error\">{error}</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex' }}>\r\n      <CssBaseline />\r\n      <AppBar position=\"fixed\" sx={{ zIndex: (theme) => theme.zIndex.drawer + 1 }}>\r\n        <Toolbar>\r\n          <Typography variant=\"h6\" noWrap component=\"div\">\r\n            Admin Dashboard\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        sx={{\r\n          width: drawerWidth,\r\n          flexShrink: 0,\r\n          [`& .MuiDrawer-paper`]: { width: drawerWidth, boxSizing: 'border-box' },\r\n        }}\r\n      >\r\n        <Toolbar />\r\n        <Box sx={{ overflow: 'auto' }}>\r\n          <List>\r\n            <ListItem button selected={selectedMenu === 'dashboard'} onClick={() => setSelectedMenu('dashboard')}>\r\n              <ListItemIcon><DashboardIcon /></ListItemIcon>\r\n              <ListItemText primary=\"Dashboard Home\" />\r\n            </ListItem>\r\n            <ListItem button selected={selectedMenu === 'menu'} onClick={() => setSelectedMenu('menu')}>\r\n              <ListItemIcon><RestaurantMenuIcon /></ListItemIcon>\r\n              <ListItemText primary=\"Menu Management\" />\r\n            </ListItem>\r\n            <ListItem button selected={selectedMenu === 'categories'} onClick={() => setSelectedMenu('categories')}>\r\n              <ListItemIcon><CategoryIcon /></ListItemIcon>\r\n              <ListItemText primary=\"Categories & Subcategories\" />\r\n            </ListItem>\r\n            <ListItem button selected={selectedMenu === 'orders'} onClick={() => setSelectedMenu('orders')}>\r\n              <ListItemIcon><RestaurantMenuIcon /></ListItemIcon>\r\n              <ListItemText primary=\"Orders\" />\r\n            </ListItem>\r\n            <ListItem button selected={selectedMenu === 'coupons'} onClick={() => setSelectedMenu('coupons')}>\r\n              <ListItemIcon><LocalOfferIcon /></ListItemIcon>\r\n              <ListItemText primary=\"Coupons & Offers\" />\r\n            </ListItem>\r\n          </List>\r\n        </Box>\r\n      </Drawer>\r\n      <Box component=\"main\" sx={{ flexGrow: 1, p: 3 }}>\r\n        <Toolbar />\r\n        {selectedMenu === 'dashboard' && (\r\n          <Box>\r\n            <Typography variant=\"h4\" gutterBottom>\r\n              Welcome, Admin!\r\n            </Typography>\r\n            <Typography variant=\"body1\">\r\n              Use the side menu to manage menu items and more.\r\n            </Typography>\r\n          </Box>\r\n        )}\r\n        {selectedMenu === 'menu' && <MenuManager />}\r\n        {selectedMenu === 'categories' && <CategoryManager />}\r\n        {selectedMenu === 'orders' && <AdminOrders />}\r\n        {selectedMenu === 'coupons' && <CouponManager />}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}