{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Tabs,Tab,Box,Typography,Button,Paper}from'@mui/material';import{useMenu}from'../context/MenuContext';import{useCart}from'../context/CartContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Menu=()=>{var _filteredCategories$f;const{menuItems,categories,getItemsForCategory}=useMenu();const{cart}=useCart();const[selectedCategory,setSelectedCategory]=useState(null);// Filter main categories only (type === 'category')\nlet filteredCategories=categories.filter(cat=>cat.type==='category');// Set selectedCategory to the first available category when categories change\nuseEffect(()=>{if(filteredCategories.length>0&&!selectedCategory){setSelectedCategory(String(filteredCategories[0].id));}},[filteredCategories,selectedCategory]);// Get items for selected category using join table\nconst items=selectedCategory?getItemsForCategory(selectedCategory):[];// Get subcategories for the selected category\nconst categorySubcategories=categories.filter(cat=>cat.type==='subcategory'&&String(cat.parent_id)===String(selectedCategory));// Group items by subcategory\nconst itemsBySubcategory=items.reduce((acc,item)=>{// Find the subcategory if it exists\nconst subcategory=categorySubcategories.find(sub=>String(sub.id)===String(item.subcategory_id));const subcategoryName=subcategory?subcategory.name:'Other';if(!acc[subcategoryName]){acc[subcategoryName]=[];}acc[subcategoryName].push(item);return acc;},{});// Debugging\nconsole.log('categories:',categories);console.log('menuItems:',menuItems);console.log('filteredCategories:',filteredCategories);console.log('selectedCategory:',selectedCategory);console.log('items:',items);return/*#__PURE__*/_jsxs(Container,{maxWidth:\"sm\",sx:{pb:10},children:[filteredCategories.length===0||!selectedCategory?/*#__PURE__*/_jsx(Typography,{align:\"center\",color:\"text.secondary\",sx:{mt:4},children:\"No categories found.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tabs,{value:selectedCategory,onChange:(e,val)=>setSelectedCategory(val),variant:\"scrollable\",scrollButtons:\"auto\",sx:{mb:2},children:filteredCategories.map(cat=>/*#__PURE__*/_jsx(Tab,{label:cat.name,value:String(cat.id)},cat.id))}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{fontWeight:700,mb:2},children:(_filteredCategories$f=filteredCategories.find(cat=>String(cat.id)===String(selectedCategory)))===null||_filteredCategories$f===void 0?void 0:_filteredCategories$f.name}),Object.entries(itemsBySubcategory).map(_ref=>{let[subcategory,subcategoryItems]=_ref;return/*#__PURE__*/_jsxs(Box,{sx:{mb:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,mb:2,color:'primary.main'},children:subcategory}),subcategoryItems.map(item=>{var _item$price;return/*#__PURE__*/_jsxs(Paper,{sx:{display:'flex',alignItems:'center',mb:2,p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{flex:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:700},children:item.name}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",sx:{fontWeight:600},children:[\"\\xA3\",(_item$price=item.price)===null||_item$price===void 0?void 0:_item$price.toFixed(2)]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",noWrap:true,children:item.description})]}),item.image_url&&/*#__PURE__*/_jsx(Box,{component:\"img\",src:item.image_url,alt:item.name,sx:{width:90,height:90,objectFit:'cover',borderRadius:2,ml:2}})]},item.id);})]},subcategory);})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",fullWidth:true,sx:{position:'fixed',left:0,bottom:0,width:'100vw',borderRadius:0,py:2,zIndex:1200},onClick:()=>{/* navigate to cart */},children:\"Go to Basket\"})]});};export default Menu;","map":{"version":3,"names":["React","useState","useEffect","Container","Tabs","Tab","Box","Typography","Button","Paper","useMenu","useCart","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Menu","_filteredCategories$f","menuItems","categories","getItemsForCategory","cart","selectedCategory","setSelectedCategory","filteredCategories","filter","cat","type","length","String","id","items","categorySubcategories","parent_id","itemsBySubcategory","reduce","acc","item","subcategory","find","sub","subcategory_id","subcategoryName","name","push","console","log","maxWidth","sx","pb","children","align","color","mt","value","onChange","e","val","variant","scrollButtons","mb","map","label","fontWeight","Object","entries","_ref","subcategoryItems","_item$price","display","alignItems","p","flex","price","toFixed","noWrap","description","image_url","component","src","alt","width","height","objectFit","borderRadius","ml","fullWidth","position","left","bottom","py","zIndex","onClick"],"sources":["E:/food-ordering-website/client/src/pages/Menu.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Container,\r\n  Tabs,\r\n  Tab,\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  Paper,\r\n} from '@mui/material';\r\nimport { useMenu } from '../context/MenuContext';\r\nimport { useCart } from '../context/CartContext';\r\n\r\nconst Menu = () => {\r\n  const { menuItems, categories, getItemsForCategory } = useMenu();\r\n  const { cart } = useCart();\r\n  const [selectedCategory, setSelectedCategory] = useState(null);\r\n\r\n  // Filter main categories only (type === 'category')\r\n  let filteredCategories = categories.filter(cat =>\r\n    cat.type === 'category'\r\n  );\r\n\r\n  // Set selectedCategory to the first available category when categories change\r\n  useEffect(() => {\r\n    if (filteredCategories.length > 0 && !selectedCategory) {\r\n      setSelectedCategory(String(filteredCategories[0].id));\r\n    }\r\n  }, [filteredCategories, selectedCategory]);\r\n\r\n  // Get items for selected category using join table\r\n  const items = selectedCategory ? getItemsForCategory(selectedCategory) : [];\r\n\r\n  // Get subcategories for the selected category\r\n  const categorySubcategories = categories.filter(cat =>\r\n    cat.type === 'subcategory' && String(cat.parent_id) === String(selectedCategory)\r\n  );\r\n\r\n  // Group items by subcategory\r\n  const itemsBySubcategory = items.reduce((acc, item) => {\r\n    // Find the subcategory if it exists\r\n    const subcategory = categorySubcategories.find(sub => String(sub.id) === String(item.subcategory_id));\r\n    const subcategoryName = subcategory ? subcategory.name : 'Other';\r\n    if (!acc[subcategoryName]) {\r\n      acc[subcategoryName] = [];\r\n    }\r\n    acc[subcategoryName].push(item);\r\n    return acc;\r\n  }, {});\r\n\r\n  // Debugging\r\n  console.log('categories:', categories);\r\n  console.log('menuItems:', menuItems);\r\n  console.log('filteredCategories:', filteredCategories);\r\n  console.log('selectedCategory:', selectedCategory);\r\n  console.log('items:', items);\r\n\r\n  return (\r\n    <Container maxWidth=\"sm\" sx={{ pb: 10 }}>\r\n      {filteredCategories.length === 0 || !selectedCategory ? (\r\n        <Typography align=\"center\" color=\"text.secondary\" sx={{ mt: 4 }}>\r\n          No categories found.\r\n        </Typography>\r\n      ) : (\r\n        <>\r\n          {/* Category Tabs */}\r\n          <Tabs\r\n            value={selectedCategory}\r\n            onChange={(e, val) => setSelectedCategory(val)}\r\n            variant=\"scrollable\"\r\n            scrollButtons=\"auto\"\r\n            sx={{ mb: 2 }}\r\n          >\r\n            {filteredCategories.map(cat => (\r\n              <Tab key={cat.id} label={cat.name} value={String(cat.id)} />\r\n            ))}\r\n          </Tabs>\r\n\r\n          {/* Category Heading */}\r\n          <Typography variant=\"h5\" sx={{ fontWeight: 700, mb: 2 }}>\r\n            {filteredCategories.find(cat => String(cat.id) === String(selectedCategory))?.name}\r\n          </Typography>\r\n\r\n          {/* Menu Items Grouped by Subcategory */}\r\n          {Object.entries(itemsBySubcategory).map(([subcategory, subcategoryItems]) => (\r\n            <Box key={subcategory} sx={{ mb: 4 }}>\r\n              {/* Subcategory Heading */}\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600, mb: 2, color: 'primary.main' }}>\r\n                {subcategory}\r\n              </Typography>\r\n\r\n              {/* Menu Items */}\r\n              {subcategoryItems.map(item => (\r\n                <Paper key={item.id} sx={{ display: 'flex', alignItems: 'center', mb: 2, p: 2 }}>\r\n                  <Box sx={{ flex: 1 }}>\r\n                    <Typography variant=\"h6\" sx={{ fontWeight: 700 }}>{item.name}</Typography>\r\n                    <Typography variant=\"body1\" sx={{ fontWeight: 600 }}>\r\n                      Â£{item.price?.toFixed(2)}\r\n                    </Typography>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\" noWrap>\r\n                      {item.description}\r\n                    </Typography>\r\n                  </Box>\r\n                  {item.image_url && (\r\n                    <Box\r\n                      component=\"img\"\r\n                      src={item.image_url}\r\n                      alt={item.name}\r\n                      sx={{ width: 90, height: 90, objectFit: 'cover', borderRadius: 2, ml: 2 }}\r\n                    />\r\n                  )}\r\n                </Paper>\r\n              ))}\r\n            </Box>\r\n          ))}\r\n        </>\r\n      )}\r\n      {/* Go to Basket Button */}\r\n      <Button\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        fullWidth\r\n        sx={{\r\n          position: 'fixed',\r\n          left: 0,\r\n          bottom: 0,\r\n          width: '100vw',\r\n          borderRadius: 0,\r\n          py: 2,\r\n          zIndex: 1200,\r\n        }}\r\n        onClick={() => {/* navigate to cart */}}\r\n      >\r\n        Go to Basket\r\n      </Button>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Menu; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}